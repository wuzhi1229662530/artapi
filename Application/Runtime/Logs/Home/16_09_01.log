[ 2016-09-01T10:27:37+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/shopcart/addshopcart
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000087s ]
INFO: [ app_init ] --END-- [ RunTime:0.032917s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.042492s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.052897s ]
INFO: [ app_begin ] --END-- [ RunTime:0.096058s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0530s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0482s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0313s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472696856' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0390s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0287s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_enshrine` [ RunTime:0.0357s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: select 
                count(e.id) as countshopcart 
                from ab_shop_enshrine e
                    inner join ab_base_goods g  on g.id = e.goods
                where 
                g.delete_status in (0)
                and g.is_online in (1)
                and g.inventory in (1)
                and e.user = 90 [ RunTime:0.0291s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0317s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0298s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_scaleboard` [ RunTime:0.0291s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_bundling` [ RunTime:0.0321s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT ab_base_goods.id,ab_base_goods.material,`longth`,`width`,`inventory`,`is_buy_framed`,sc.id as board_id FROM `ab_base_goods`  left join ab_base_scaleboard sc on sc.goodsid = ab_base_goods.id and sc.delete_status in (0)  WHERE ( ab_base_goods.is_online in (1) and  ab_base_goods.delete_status in (0) and ab_base_goods.id = 3473 ) LIMIT 1   [ RunTime:0.0562s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT  
                        r.r_width as width,
                        r.inventory,
                        r.unit_price,
                        r.length,
                        r.auxiliary_price,
                        r.operation_price,
                        r.auxiliary_price2
                    FROM
                        ab_shop_rahmen r
                    WHERE r.id = 49 AND r.delete_status IN (0) [ RunTime:0.0303s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT `id`,`frame`,`backColor` FROM `ab_shop_enshrine` WHERE ( user = 90 and goods = 3473  ) LIMIT 1   [ RunTime:0.0425s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT
                    r.id,
                    r.code,
                    r.inventory,
                    r.unit_price,
                    r.length,
                    r.auxiliary_price
                FROM
                    ab_shop_rahmen r
                WHERE r.delete_status in (0)
                    AND r.type = 2
                    AND r.code in (8610) [ RunTime:0.0312s ]
SQL: INSERT INTO `ab_shop_enshrine` (`user`,`frame`,`frame_price`,`frame_count`,`frame_in_count`,`inline_id`,`goods`,`create_time`) VALUES ('90','49','35','4','4','35','3473','2016-09-01 10:27:37') [ RunTime:0.0389s ]

[ 2016-09-01T10:39:08+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/createorder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000060s ]
INFO: [ app_init ] --END-- [ RunTime:0.001140s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001594s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.004280s ]
INFO: [ app_begin ] --END-- [ RunTime:0.006534s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0316s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0337s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0340s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472697543' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0447s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0300s ]
SQL: SHOW COLUMNS FROM `ab_shop_address` [ RunTime:0.0302s ]
SQL: SELECT ab_shop_address.id,ab_shop_address.ext,ab_shop_address.email,ab_shop_address.is_default,ab_shop_address.phone,ab_shop_address.postcode,ab_shop_address.addr,ab_shop_address.address,ab_shop_address.firstname,ab_shop_address.lastname,ab_shop_address.area,ab_shop_address.city,ab_shop_address.province,ab_shop_address.user_id,ab_shop_address.accept_name as addr_username,(select a.name from ab_base_area as a where a.id = ab_shop_address.province) as state_name,ab_shop_address.mobile,(select a.simple_code from ab_base_area as a where a.id = ab_shop_address.province) as state,CONCAT(addr,' ',`address`,' ',`city`,' ',(select a.name from ab_base_area as a where a.id = ab_shop_address.province) ) as real_address FROM `ab_shop_address` WHERE (  ab_shop_address.delete_status in (0) and ab_shop_address.adr_type in (0)  and  user_id = 90 and is_default in (1) ) LIMIT 1   [ RunTime:0.0307s ]
SQL: SHOW COLUMNS FROM `ab_shop_enshrine` [ RunTime:0.0302s ]
SQL: select
                    CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(g.cover_path,'.',1),'_s',SUBSTRING(g.cover_path,LENGTH(SUBSTRING_INDEX(g.cover_path,'.',1))+1,LENGTH(g.cover_path)))) as img_url,
                    CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,
                    CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img, CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img, CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img, CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img, CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img, CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img, CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img, CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img,
                    r.r_weight as rahmen_weight,
                    r.inventory as rahmen_inventory,
                    e.id,
                    r.name as rahmen_name,
                    (SELECT
                        fs.setting
                    FROM
                        ab_shop_free_shipping fs
                    WHERE
                        fs.delete_status in (0)
                        AND fs.startTime < now()
                        AND fs.endTime > now()
                        AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId=e.goods )) ORDER BY fs.id ASC limit 1
                    ) as freeshipmoney,
                    r.r_size as rahmen_size,
                    r.r_width as rahmen_width,
                    e.goods, 
                    e.backColor,
                     e.colorName   ,
                    e.backSize,
                    e.frame as rahmen_id, 
                    e.frame_price as price,
                    e.frame_count,
                    e.frame_in_count,
                    e.inline_id,
                    g.title as name, 
                    g.id as goods_id,
                    g.inventory,
                    g.weight,
                    ag.type,
                    g.recommended,
                    CONCAT('ShopGoodsID_',  g.id) as jump_url,
                    g.sell_price,
                    g.longth as goods_longth,
                    g.width as goods_width,
                    CONCAT(round(g.longth),'×', round(g.width) ) as size,
                    a.name as authorname,
                    (select r.inventory from ab_shop_rahmen r where e.inline_id = r.id ) inline_inventory,
                    (select d.dictname from sys_diction d where d.id = g.medium) as medium
                from ab_shop_enshrine e 
                    left join ab_base_goods g on e.goods = g.id
                    left join ab_base_author_goods ag on g.id = ag.goods
                    left join ab_base_author a on ag.author = a.id
                    left join ab_shop_rahmen r on e.frame = r.id and r.delete_status in (0)
                where e.id in (3007) and  
                  user = 90 
                and g.is_online in (1) 
                and g.delete_status in (0)
                and ag.delete_status in (0)
                and a.name is not null
                and ag.type in (1)
                order  by e.create_time
                 [ RunTime:0.4073s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0303s ]
NOTIC: [8] Undefined variable: money1 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 179 行.
NOTIC: [8] Undefined variable: money2 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 185 行.
NOTIC: [8] Undefined variable: money3 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 191 行.
NOTIC: [8] Undefined variable: money4 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 197 行.
NOTIC: [8] Undefined variable: error2 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 214 行.
NOTIC: [8] Undefined variable: feightmoney G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 226 行.
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0316s ]
SQL: INSERT INTO `ab_shop_order` (`user_id`,`order_no`,`payment`,`pay_status`,`payable_amount`,`adjust_taxes`,`taxes`,`is_invoice`,`order_amount`,`status`,`delete_status`,`create_time`,`update_time`,`rahmen_price`,`order_source`) VALUES ('90','20160901103907478','0','0','1385','0.08875','122.92','0','1507.92','1','0','2016-09-01 10:39:07','2016-09-01 10:39:07','0','3') [ RunTime:0.0752s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_express` [ RunTime:0.0328s ]
SQL: INSERT INTO `ab_shop_order_express` (`order_id`,`accept_name`,`phone`,`mobile`,`province`,`city`,`billing_id`,`address`,`addr`,`zip`,`address_id`,`goods_invoice`,`delete_status`,`create_time`) VALUES ('1541','Wuwjjj Zhi','','3123451234','219','New York','63','','555 Lexington Avenue','10022','63','0','0','2016-09-01 10:39:07') [ RunTime:0.0438s ]
SQL: INSERT INTO `ab_shop_order_goods` (`order_goods_no`,`order_id`,`goods_id`,`rahmen_id`,`rahmen_price`,`frame_count`,`frame_in_count`,`inline_id`,`backSize`,`weight`,`width`,`length`,`height`,`box`,`bags`,`backColor`,`colorName`,`goods_price`,`is_postage`,`delete_status`,`create_time`,`ups_service_code`,`isfree`) VALUES ('20160901103907478','1541','3473','49','35','4','4','35',NULL,'1','49.2','49.2','5.12','6','Bag34',NULL,NULL,'1350','0','0','2016-09-01 10:39:07','03','1') [ RunTime:0.0371s ]
SQL: DELETE FROM `ab_shop_enshrine` WHERE `id` IN ('3007') AND `user` = 90 [ RunTime:0.0309s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0394s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0659s ]
SQL: update ab_base_goods set inventory = 0 where inventory > 0 and  id in (3473) [ RunTime:0.0353s ]
SQL: update ab_shop_rahmen set inventory = inventory - 4 where inventory - 4 >= 0  and id in (49)  [ RunTime:0.0334s ]
SQL: update ab_shop_rahmen set inventory = inventory - 4 where inventory - 4 >= 0  and id in (35)  [ RunTime:0.0304s ]

[ 2016-09-01T10:41:00+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/editorder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000085s ]
INFO: [ app_init ] --END-- [ RunTime:0.001161s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001523s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.004537s ]
INFO: [ app_begin ] --END-- [ RunTime:0.007701s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0282s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0267s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0274s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472697659' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0490s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0263s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0287s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0275s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0322s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0278s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT ab_shop_order.id as order_id,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)  and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1541 and ab_shop_order.pay_status = 0 ) ORDER BY ab_shop_order.create_time desc  [ RunTime:0.0340s ]
NOTIC: [8] Undefined variable: money1 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 959 行.
NOTIC: [8] Undefined variable: money2 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 965 行.
NOTIC: [8] Undefined variable: money3 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 971 行.
NOTIC: [8] Undefined variable: money4 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 977 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_address` [ RunTime:0.0269s ]
NOTIC: [8] Undefined variable: feightmoney G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 1037 行.

[ 2016-09-01T10:42:52+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/orderDetail
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000088s ]
INFO: [ app_init ] --END-- [ RunTime:0.001141s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001555s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.005149s ]
INFO: [ app_begin ] --END-- [ RunTime:0.007386s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0282s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0290s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0279s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472697771' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0346s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0290s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0296s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0287s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0303s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0283s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SELECT ab_shop_order.id as order_id,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_shop_order.user_id = 90 and ab_shop_order.id = 1541 ) ORDER BY ab_shop_order.create_time desc  [ RunTime:0.0350s ]
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 153 行.
NOTIC: [8] Undefined index: HTTP_TYPE G:\wamp\www\artbean2\code\trunk\webService\ThinkPHP\Library\Think\Db\Driver.class.php 第 155 行.
SQL: SHOW COLUMNS FROM `ab_shop_address` [ RunTime:0.0281s ]

[ 2016-09-01T10:44:33+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000069s ]
INFO: [ app_init ] --END-- [ RunTime:0.001285s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001893s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.002646s ]
INFO: [ app_begin ] --END-- [ RunTime:0.005068s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0280s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0274s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0273s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472697873' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0348s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0272s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0283s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0305s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0301s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0288s ]
ERR: 1064:You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%d)) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.vouch' at line 1
 [ SQL语句 ] : SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM b_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= %d)) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc 
NOTIC: [8] Undefined variable: addr G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 763 行.

[ 2016-09-01T10:45:40+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000087s ]
INFO: [ app_init ] --END-- [ RunTime:0.001247s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001563s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.003288s ]
INFO: [ app_begin ] --END-- [ RunTime:0.005599s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0376s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0389s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0298s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472697940' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0439s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0296s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0330s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0307s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0336s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0317s ]
ERR: 1064:You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%d)) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.vouch' at line 1
 [ SQL语句 ] : SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM b_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= %d)) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc 
ERR: 1064:You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%d)) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.vouch' at line 1
 [ SQL语句 ] : SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM b_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= %d)) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc 

[ 2016-09-01T10:48:35+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000086s ]
INFO: [ app_init ] --END-- [ RunTime:0.001182s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002139s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.002949s ]
INFO: [ app_begin ] --END-- [ RunTime:0.005897s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0282s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0276s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0296s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472698115' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0403s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0271s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0294s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0378s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0389s ]
ERR: 1146:Table 'artbean.b_shop_free_shipping' doesn't exist
 [ SQL语句 ] : SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM b_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= ab_base_goods.id )) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc 
NOTIC: [8] Undefined variable: addr G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 763 行.

[ 2016-09-01T10:49:35+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000059s ]
INFO: [ app_init ] --END-- [ RunTime:0.001122s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001507s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.002673s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004853s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0321s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0415s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0415s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472698175' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0392s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0309s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0321s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0310s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0349s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0346s ]
ERR: 1146:Table 'artbean.b_shop_free_shipping' doesn't exist
 [ SQL语句 ] : SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM b_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= ab_base_goods.id )) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc 
ERR: 1146:Table 'artbean.b_shop_free_shipping' doesn't exist
 [ SQL语句 ] : SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM b_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= ab_base_goods.id )) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc 

[ 2016-09-01T10:50:26+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000090s ]
INFO: [ app_init ] --END-- [ RunTime:0.001463s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001486s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.002697s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004834s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0296s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0309s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0291s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472698225' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0495s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0386s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0301s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0328s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0363s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0304s ]
SQL: SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM ab_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= ab_base_goods.id )) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc  [ RunTime:0.0404s ]

[ 2016-09-01T10:52:18+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000084s ]
INFO: [ app_init ] --END-- [ RunTime:0.001213s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001654s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.003534s ]
INFO: [ app_begin ] --END-- [ RunTime:0.005818s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0323s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0321s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0310s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472698338' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0403s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0332s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0321s ]
SQL: SHOW COLUMNS FROM `ab_shop_address` [ RunTime:0.0342s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0342s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0323s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0389s ]
SQL: SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM ab_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= ab_base_goods.id )) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc  [ RunTime:0.0387s ]

[ 2016-09-01T10:53:48+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000064s ]
INFO: [ app_init ] --END-- [ RunTime:0.001319s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001511s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.002614s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004858s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0283s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0280s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0278s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472698428' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0441s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0271s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0287s ]
SQL: SHOW COLUMNS FROM `ab_shop_address` [ RunTime:0.0295s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0273s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0344s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0309s ]
SQL: SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM ab_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= ab_base_goods.id )) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc  [ RunTime:0.0415s ]

[ 2016-09-01T10:54:15+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000064s ]
INFO: [ app_init ] --END-- [ RunTime:0.003131s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001687s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.002948s ]
INFO: [ app_begin ] --END-- [ RunTime:0.005392s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0319s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0272s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0271s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472698455' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0338s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0268s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0421s ]
SQL: SHOW COLUMNS FROM `ab_shop_address` [ RunTime:0.0518s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0302s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0304s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0281s ]
SQL: SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM ab_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= ab_base_goods.id )) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1424  ) ORDER BY ab_shop_order.create_time desc  [ RunTime:0.0539s ]

[ 2016-09-01T10:55:19+08:00 ] ::1 /artbean2/code/trunk/webservice/index.php/home/order/payOrder
INFO: [ app_init ] --START--
INFO: Run Behavior\BuildLiteBehavior [ RunTime:0.000066s ]
INFO: [ app_init ] --END-- [ RunTime:0.001561s ]
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001534s ]
INFO: Run Behavior\CheckLangBehavior [ RunTime:0.002661s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004808s ]
SQL: SHOW COLUMNS FROM `ab_base_user` [ RunTime:0.0312s ]
SQL: SHOW COLUMNS FROM `ab_base_session` [ RunTime:0.0338s ]
SQL: SELECT `id`,`token`,`lastactive` FROM `ab_base_session` WHERE (  email = '501368569@qq.com'   ) LIMIT 1   [ RunTime:0.0363s ]
SQL: UPDATE `ab_base_session` SET `lastactive`='1472698502' WHERE (  email = '501368569@qq.com' and token = 'da8cDrhAhCVZZeh1jfssF%2BmiptPx9Q6glRgUeZ8M2fEK6tmYMj8ptdqP277qvBVdxABEWAjGXaBm4idEQr936lqtEoahPLr5FtAc455eYes%2BNVpUjtWgbqhGQfQ'  ) [ RunTime:0.0396s ]
SQL: SELECT `id`,`is_able`,`username` FROM `ab_base_user` WHERE ( user_status in (1) and delete_status in (0) and email= "501368569@qq.com" and id = 90 ) LIMIT 1   [ RunTime:0.0323s ]
SQL: SHOW COLUMNS FROM `ab_shop_order` [ RunTime:0.0338s ]
SQL: SHOW COLUMNS FROM `ab_shop_address` [ RunTime:0.0325s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_goods` [ RunTime:0.0331s ]
SQL: SHOW COLUMNS FROM `ab_base_goods` [ RunTime:0.0317s ]
SQL: SHOW COLUMNS FROM `ab_shop_rahmen` [ RunTime:0.0317s ]
SQL: SELECT ab_shop_order.id as order_id,og.id as ogid,(SELECT fs.setting FROM ab_shop_free_shipping fs  WHERE fs.delete_status in (0)  AND fs.startTime < now() AND fs.endTime > now() AND (fs.type in (0) OR (select id from ab_shop_free_shipping_goods b where b.freeId=fs.id and b.goodsId= ab_base_goods.id )) ORDER BY fs.id ASC limit 1 ) as freeshipmoney,og.isfree,ab_shop_order.voucher,CONCAT( FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 5 day)),'%M %e,%Y'),' - ',FROM_UNIXTIME( UNIX_TIMESTAMP(DATE_ADD(ab_shop_order.create_time,INTERVAL 10 day)),'%M %e,%Y')) as estimated_delivery,ab_shop_order.use_account_amount,ab_shop_order.ups_service_code,ab_shop_order.order_source,og.inline_id,ab_base_goods.pro_no,og.colorName,og.shipNumber,e.ext,ab_base_goods.longth as goods_longth,ab_base_goods.g_integral,ab_base_goods.width as goods_width,og.backColor,og.rahmen_price,og.backSize,og.frame_count,og.frame_in_count,og.inline_id,r.r_size as rahmen_size,r.r_width as rahmen_width,(select CONCAT('http://50.97.37.167:8080/art/',p.logo) as bank_logo from ab_shop_pay_plugin p where p.id = ab_shop_order.payment) as peyment_name,ab_shop_order.payable_freight,e.billing_id,ab_shop_order.create_time,CONCAT(round(ab_base_goods.longth),'×',round(ab_base_goods.width) ) as size,e.addr,e.address,e.city,(select ar.name from ab_base_area as ar where ar.id = e.province) as state_name,CONCAT( e.addr,' ',e.address,' ',e.city,' ',(select ar.name from ab_base_area as ar where ar.id = e.province) ) as real_address,e.zip,e.mobile,e.accept_name,e.phone,ab_shop_order.status,ab_shop_order.pay_status,ab_shop_order.order_amount,ab_shop_order.order_no,e.address_id,e.ups_no,ab_shop_order.payable_amount,ab_shop_order.taxes,ab_base_author.name as authorname,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.r_img_path,'.',1),'_s',SUBSTRING(r.r_img_path,LENGTH(SUBSTRING_INDEX(r.r_img_path,'.',1))+1,LENGTH(r.r_img_path)))) as rahmen_img_url,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1),'_s',SUBSTRING(ab_base_goods.cover_path,LENGTH(SUBSTRING_INDEX(ab_base_goods.cover_path,'.',1))+1,LENGTH(ab_base_goods.cover_path)))) as goods_img_url,ab_base_goods.weight as goods_weight,ab_base_goods.sell_price as goods_price,(select d.dictname from sys_diction d where d.id = ab_base_goods.medium) as medium,ab_base_goods.title as goods_name,r.name as rahmen_name,r.r_weight as rahmen_weight,og.id as order_goods_id,og.goods_id,og.rahmen_id,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_left_img,'.',1),'_s',SUBSTRING(r.top_left_img,LENGTH(SUBSTRING_INDEX(r.top_left_img,'.',1))+1,LENGTH(r.top_left_img)))) as top_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.top_right_img,'.',1),'_s',SUBSTRING(r.top_right_img,LENGTH(SUBSTRING_INDEX(r.top_right_img,'.',1))+1,LENGTH(r.top_right_img)))) as top_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_left_img,'.',1),'_s',SUBSTRING(r.bottom_left_img,LENGTH(SUBSTRING_INDEX(r.bottom_left_img,'.',1))+1,LENGTH(r.bottom_left_img)))) as bottom_left_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.bottom_right_img,'.',1),'_s',SUBSTRING(r.bottom_right_img,LENGTH(SUBSTRING_INDEX(r.bottom_right_img,'.',1))+1,LENGTH(r.bottom_right_img)))) as bottom_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_top_img,'.',1),'_s',SUBSTRING(r.border_top_img,LENGTH(SUBSTRING_INDEX(r.border_top_img,'.',1))+1,LENGTH(r.border_top_img)))) as border_top_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_bottom_img,'.',1),'_s',SUBSTRING(r.border_bottom_img,LENGTH(SUBSTRING_INDEX(r.border_bottom_img,'.',1))+1,LENGTH(r.border_bottom_img)))) as border_bottom_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_right_img,'.',1),'_s',SUBSTRING(r.border_right_img,LENGTH(SUBSTRING_INDEX(r.border_right_img,'.',1))+1,LENGTH(r.border_right_img)))) as border_right_img,CONCAT('http://50.97.37.171',CONCAT(SUBSTRING_INDEX(r.border_left_img,'.',1),'_s',SUBSTRING(r.border_left_img,LENGTH(SUBSTRING_INDEX(r.border_left_img,'.',1))+1,LENGTH(r.border_left_img)))) as border_left_img FROM `ab_shop_order` INNER JOIN ab_shop_order_goods og on ab_shop_order.id = og.order_id INNER JOIN ab_base_goods  on  ab_base_goods.id = og.goods_id  left join ab_shop_rahmen r on r.id = og.rahmen_id and r.delete_status in (0) INNER JOIN  ab_base_author_goods  on ab_base_goods.id = ab_base_author_goods.goods and ab_base_author_goods.delete_status in (0) and ab_base_author_goods.type in (1)   left join ab_base_author on ab_base_author_goods.author = ab_base_author.id and ab_base_author.delete_status in (0)  left join ab_shop_order_express e on ab_shop_order.id = e.order_id and e.delete_status in (0)  WHERE ( ab_shop_order.delete_status in (0)   and ab_base_author_goods.type = 1  and ab_shop_order.user_id = 90 and ab_shop_order.id = 1541  ) ORDER BY ab_shop_order.create_time desc  [ RunTime:0.0371s ]
SQL: SHOW COLUMNS FROM `ab_shop_order_status` [ RunTime:0.0310s ]
SQL: SELECT `id`,`order_id`,`status` FROM `ab_shop_order_status` WHERE ( order_id = 1541 ) LIMIT 1   [ RunTime:0.0307s ]
SQL: INSERT INTO `ab_shop_order_status` (`order_id`,`status`,`time`) VALUES ('1541','0','2016-09-01 10:55:03') [ RunTime:0.0374s ]
NOTIC: [8] Undefined index: method G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 541 行.
SQL: update ab_shop_order_goods set isfree = 1, ups_service_code = '', shipfeight = 0 where id = 1967 [ RunTime:0.0386s ]
SQL: SHOW COLUMNS FROM `ab_shop_pay_plugin` [ RunTime:0.0309s ]
SQL: SELECT id as payment,name as bankname FROM `ab_shop_pay_plugin` WHERE ( name = "Visa" ) LIMIT 0,1   [ RunTime:0.0304s ]
NOTIC: [8] Undefined variable: eamil G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 806 行.
NOTIC: [2] implode(): Invalid arguments passed G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 809 行.
SQL: SHOW COLUMNS FROM `ab_trans_info` [ RunTime:0.0358s ]
SQL: INSERT INTO `ab_trans_info` (`transId`,`orderId`,`amount`,`result`,`create_time`,`tax_amount`,`shipping_amount`,`cardNum`,`cardExpress`,`secretNum`,`source`) VALUES ('40002563358','1541','1507.92','Ok','2016-09-01 10:55:03','122.92','0','4111111111111111','1216','1234','3') [ RunTime:0.0304s ]
SQL: UPDATE `ab_shop_order` SET `pay_status`='1',`cardNum`='4111111111111111',`payment`='1',`bank_name`='Visa',`ups_service_code`='03',`pay_time`='2016-09-01 10:55:03',`real_amount`='1385',`is_fast`='0',`payable_freight`='0',`real_freight`='0',`order_amount`='1507.92',`update_time`='2016-09-01 10:55:03' WHERE (  id = 1541 and user_id = 90 ) [ RunTime:0.0306s ]
NOTIC: [8] Undefined variable: res2 G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 715 行.
NOTIC: [8192] Function split() is deprecated G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 722 行.
NOTIC: [8] Undefined index: firstname G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 729 行.
NOTIC: [8] Undefined index: lastname G:\wamp\www\artbean2\code\trunk\webService\Application\Home\Controller\OrderController.class.php 第 729 行.
SQL: DELETE FROM `ab_shop_order_status` WHERE ( order_id = 1541 ) [ RunTime:0.0442s ]

